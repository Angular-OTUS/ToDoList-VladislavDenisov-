<main>
    <header>
        <h1>Todo list</h1>
    </header>
    @if (isLoading) {
        <mat-spinner class="loading-spinner"></mat-spinner>
    } @else {
        <section class="task-list">
            <ul class="task-list__list">
                <app-to-do-list-item *ngFor="let toDoListItem of toDoList" [toDoListItem]="toDoListItem" [isSelected]="getIsItemSelected(toDoListItem.id)" (deleteToDoListItemEvent)="deleteItem($event)" (setSelectedItemIdEvent)="setSelectedItemId($event)"></app-to-do-list-item>
            </ul> 
            @if (selectedItem) {
                <app-to-do-list-item-description [toDoListItem]="selectedItem" class="task-list__description"></app-to-do-list-item-description>
            }
        </section>
        <section>
            <form class="add-new-todo-form">
                <mat-form-field class="add-new-todo-form__formfield">
                    <input matInput [formControl]="toDoListForm.controls.name" type="text" placeholder="Add your new todo" name="name" />
                    @if (toDoListForm.controls.name.hasError('required') || toDoListForm.controls.name.hasError('whitespace')) {
                        <mat-error>Name is <strong>required</strong></mat-error>
                    }
                </mat-form-field>
                <mat-form-field class="add-new-todo-form__formfield">
                    <textarea matInput [formControl]="toDoListForm.controls.description" type="text" placeholder="Add description" name="descriptionInput"></textarea>
                </mat-form-field>
                <app-button appCustomTooltip="Add new todo item" [disabled]="toDoListForm.controls.name.invalid" (buttonClick)="addItem({text: toDoListForm.controls.name.value!, description: toDoListForm.controls.description.value!})" title="Add" class="button__add"></app-button>
            </form>
        </section>
    }
</main>
